<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
  <h2>–ê–Ω–∞–ª–∏–∑ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∑–∞ {{ days }} –¥–Ω–µ–π</h2>

  <h3>–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</h3>
  <table border="1" cellpadding="5">
    <tr>
      <th>–ê–∫—Ç–∏–≤</th>
      <th>–°—Ä–µ–¥–Ω—è—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (–ø—É–Ω–∫—Ç—ã)</th>
      <th>–°—Ä–µ–¥–Ω—è—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (%)</th>
    </tr>

    {% for row in crypto_results %}
    <tr>
      <td>{{ row.symbol }}</td>
      <td>{{ row.average_volatility_points }}</td>
      <td>{{ row.average_volatility_percent }}</td>
    </tr>
    {% endfor %}

    <tr>
      <td>{{ sp500_result.symbol }}</td>
      <td>{{ sp500_result.average_volatility_points }}</td>
      <td>{{ sp500_result.average_volatility_percent }}</td>
    </tr>
  </table>

  <h3>üìÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è</h3>
  <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 20px;">
    {% for coin, table in zip(crypto_results, crypto_tables) %}
      <div style="flex: 1 1 300px; min-width: 300px;">
        <h4>{{ coin.symbol }}</h4>
        <table border="1" cellpadding="5">
          <tr>
            <th>–î–∞—Ç–∞</th>
            <th>–ü—É–Ω–∫—Ç—ã</th>
            <th>–ò–∑–º–µ–Ω–µ–Ω–∏–µ (%)</th>
          </tr>
          {% for row in table %}
          <tr>
            <td>{{ row.date }}</td>
            <td>{{ row.points }}</td>
            <td>{{ row.percent_change }}</td>
          </tr>
          {% endfor %}
        </table>
      </div>
    {% endfor %}

    <div style="flex: 1 1 300px; min-width: 300px;">
      <h4>S&P500</h4>
      <table border="1" cellpadding="5">
        <tr>
          <th>–î–∞—Ç–∞</th>
          <th>–ü—É–Ω–∫—Ç—ã</th>
          <th>–ò–∑–º–µ–Ω–µ–Ω–∏–µ (%)</th>
        </tr>
        {% for row in sp500_table %}
        <tr>
          <td>{{ row.date }}</td>
          <td>{{ row.points }}</td>
          <td>{{ row.percent_change }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>
  </div>

  <br>
  <style>
    .btn-link {
      display: inline-block;
      padding: 12px 20px;
      margin: 10px 10px 20px 0;
      font-size: 16px;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 500;
    }
    .btn-download {
      background-color: #28a745;
      color: white;
    }
    .btn-download:hover {
      background-color: #218838;
    }
    .btn-back {
      background-color: #007bff;
      color: white;
    }
    .btn-back:hover {
      background-color: #0056b3;
    }
  </style>

  <a href="{{ report_url }}" download class="btn-link btn-download">üì• –°–∫–∞—á–∞—Ç—å PDF-–æ—Ç—á—ë—Ç</a>
  <a href="/" class="btn-link btn-back">üîô –ù–∞–∑–∞–¥</a>

<!-- —É–¥–∞–ª—ë–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ <h3>–ì—Ä–∞—Ñ–∏–∫ –¥–Ω–µ–≤–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</h3> -->

  <div id="volatility-plot" style="width: 100%; height: 500px;"></div>

  {% if plot_data %}
  <script>
    const plotData = {{ plot_data | safe }};
    Plotly.newPlot('volatility-plot', plotData, {
      title: '–ì—Ä–∞—Ñ–∏–∫ –¥–Ω–µ–≤–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏',
      xaxis: { title: '–î–∞—Ç–∞' },
      yaxis: { title: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ (%)' }
    });
  </script>
  {% else %}
  <p style="color: red;">‚ö†Ô∏è –ì—Ä–∞—Ñ–∏–∫ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–æ–±—Ä–∞–∂—ë–Ω ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ.</p>
  {% endif %}
</body>
</html>

